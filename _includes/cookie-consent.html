<style>
    #cookie-notice {padding: 0.5rem 1rem; display: none; text-align: center; position: fixed; top: 0; left: 0; right: 0; width: 100%; z-index: 9999; background: #222; color: rgba(255,255,255,0.8);}
    #cookie-notice a {display: inline-block; cursor: pointer; margin-left: 0.5rem;}
    @media (max-width: 767px) {
        #cookie-notice span {display: block; padding-top: 3px; margin-bottom: 1rem;}
        #cookie-notice a {position: relative; bottom: 4px;}
    }
</style>
<div id="cookie-notice"><span>We would like to use cookies to improve your use of the website</span><a id="cookie-notice-accept" class="btn btn-primary btn-sm">Approve</a><a href="/privacy" class="btn btn-primary btn-sm">More info</a></div>
<script>
    function createCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }

    // Grant consent immediately if already approved
    if(readCookie('cookie-notice-dismissed')=='true') {
        if (typeof gtag !== 'undefined') {
            gtag('consent', 'update', {
                'analytics_storage': 'granted'
            });
        }
    }

    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
        if(readCookie('cookie-notice-dismissed')=='true') {
            {% include cookies.js %}

            setTimeout(() => {
                var article = document.getElementsByTagName("article")[0];
                if (article) article.style.padding = "2em 1em";
            }, 500);
        } else {
            var cookieNotice = document.getElementById('cookie-notice');
            if (cookieNotice) {
                cookieNotice.style.display = 'block';
            }
            setTimeout(() => {
                var article = document.getElementsByTagName("article")[0];
                if (article) article.style.padding = "5em 1em";
            }, 500);
        }

        var acceptButton = document.getElementById('cookie-notice-accept');
        if (acceptButton) {
            acceptButton.addEventListener("click", function() {
                createCookie('cookie-notice-dismissed','true',31);
                var cookieNotice = document.getElementById('cookie-notice');
                if (cookieNotice) cookieNotice.style.display = 'none';

                // Update Google Analytics consent
                if (typeof gtag !== 'undefined') {
                    gtag('consent', 'update', {
                        'analytics_storage': 'granted'
                    });
                }

                location.reload();
            });
        }
    });

</script>
